extends layout.pug

block append head
    script(src='/javascripts/moment-2.20.1.min.js')

block scripts
    script.
        $(function() {
            var originalFrom = $('#previous-btn').data('current-date');
            var originalTo = $('#next-btn').data('current-date');
            $('#previous-btn').click(function() {
                var from = moment(originalFrom).isoWeekday(-6).format('YYYY-MM-DD');;
                var to = originalFrom;
                window.location.href = '/statistics/' + from + '/' + to;
            });
            $('#next-btn').click(function() {
                var from = originalTo;
                var to = moment(originalTo).isoWeekday(8).format('YYYY-MM-DD');;;
                window.location.href = '/statistics/' + from + '/' + to;
            });
        });


block content
    div(style='margin-top: 20px;')
        div(class='pull-left text-left' style='margin-bottom: 20px;')
            button(id='previous-btn' class='btn btn-primary' data-current-date=statistics.from) << Previous
        div(class='pull-right text-right')
            button(id='next-btn' class='btn btn-primary' data-current-date=statistics.to) Next >>

    div
        div(style='clear: both;')
            h2= "Statistics (" + statistics.from + " to " + statistics.to + ")"

        if statistics.length === 0
            p No matches played ...
        else
            div(class='table')
                table(id='current-week-statistics-table' class='table')
                    thead
                        tr
                            th(colspan='7')
                            th(colspan='4' class='th-bordered') Per Game
                            th(colspan='3' class='th-bordered') Accuracy
                        tr
                            th(class='txt-right') Rank
                            th Player
                            th(class='txt-center') Played
                            th(class='txt-center') Won
                            th(class='txt-right') Win %
                            th(class='txt-center') PPD / First 9
                            th(class='txt-right') Checkout
                            th(class='txt-right') 60s+
                            th(class='txt-right') 100s+
                            th(class='txt-right') 140s+
                            th(class='txt-right') 180
                            th(class='txt-right') Overall
                            th(class='txt-right') 20s
                            th(class='txt-right') 19s
                    tbody
                        - var rank = 1
                        each stats in statistics
                            - var player = players[stats.player_id]
                            tr
                                td(class='txt-right')= rank++
                                td(style='width: 12%'): a(href='/players/' + player.id + '/statistics')= player.name
                                td(class='txt-center')= stats.games_played
                                td(class='txt-center')= stats.games_won === undefined ? 0 : stats.games_won
                                td(class='txt-right')= stats.games_won === undefined ? 0 : (stats.games_won / stats.games_played * 100).toFixed(2)
                                td(class='txt-center')= stats.ppd.toFixed(2) + ' / ' + stats.first_nine_ppd.toFixed(2)
                                td(class='txt-right')= stats.checkout_percentage.toFixed(2) + ' %'
                                td(class='txt-right')= (stats.scores_60s_plus / stats.games_played).toFixed(2)
                                td(class='txt-right')= (stats.scores_100s_plus / stats.games_played).toFixed(2)
                                td(class='txt-right')= (stats.scores_140s_plus / stats.games_played).toFixed(2)
                                td(class='txt-right')= (stats.scores_180s / stats.games_played).toFixed(2)
                                td(class='txt-right')= stats.accuracy_overall === null ? '-' : stats.accuracy_overall.toFixed(2)
                                td(class='txt-right')= stats.accuracy_20 === null ? '-' : stats.accuracy_20.toFixed(2)
                                td(class='txt-right')= stats.accuracy_19 === null ? '-' : stats.accuracy_19.toFixed(2)